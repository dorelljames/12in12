---
import Layout from "../layouts/Layout.astro";
import Navbar from "../components/Navbar.astro";
import Footer from "../components/Footer.astro";
---

<Layout title="Join the Challenge - 12 in 12">
  <Navbar />

  <main class="bg-slate-900 pt-24 pb-16">
    <div class="relative">
      <div class="absolute inset-0 bg-grid-slate-800/[0.1] bg-[size:40px_40px]">
      </div>
      <div
        class="absolute inset-0 bg-gradient-to-b from-slate-900/50 to-slate-900"
      >
      </div>

      <div class="relative mx-auto max-w-2xl px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16 animate-fade-in">
          <span class="text-primary-400 font-medium">Join the Challenge ðŸ’ª</span
          >
          <h1
            class="mt-2 text-3xl font-bold tracking-tight text-white sm:text-4xl"
          >
            Let's Build Something Amazing Together
          </h1>
          <p class="mt-4 text-lg text-slate-300">
            I'm excited to have you join this journey. Let's get to know each
            other a bit better.
          </p>
        </div>

        <form
          id="signup-form"
          class="space-y-8 animate-slide-up bg-slate-800/50 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50"
        >
          <div class="space-y-6">
            <div>
              <label
                for="name"
                class="block text-sm font-medium text-slate-300"
              >
                What should I call you?
              </label>
              <div class="mt-2">
                <input
                  type="text"
                  name="name"
                  id="name"
                  required
                  class="block w-full rounded-md border-0 bg-slate-700/50 py-2 px-3 text-white shadow-sm ring-1 ring-inset ring-slate-600 placeholder:text-slate-400 focus:ring-2 focus:ring-inset focus:ring-primary-500"
                  placeholder="Your name"
                />
              </div>
            </div>

            <div>
              <label
                for="email"
                class="block text-sm font-medium text-slate-300"
              >
                Where can I reach you?
              </label>
              <div class="mt-2">
                <input
                  type="email"
                  name="email"
                  id="email"
                  required
                  class="block w-full rounded-md border-0 bg-slate-700/50 py-2 px-3 text-white shadow-sm ring-1 ring-inset ring-slate-600 placeholder:text-slate-400 focus:ring-2 focus:ring-inset focus:ring-primary-500"
                  placeholder="your@email.com"
                />
              </div>
            </div>

            <div>
              <label
                for="reason"
                class="block text-sm font-medium text-slate-300"
              >
                What excites you most about this challenge?
              </label>
              <div class="mt-2">
                <textarea
                  id="reason"
                  name="reason"
                  rows="4"
                  required
                  class="block w-full rounded-md border-0 bg-slate-700/50 py-2 px-3 text-white shadow-sm ring-1 ring-inset ring-slate-600 placeholder:text-slate-400 focus:ring-2 focus:ring-inset focus:ring-primary-500"
                  placeholder="Share your thoughts..."></textarea>
              </div>
              <p class="mt-2 text-sm text-slate-400">
                This helps me understand how I can better support you in your
                journey.
              </p>
            </div>
          </div>

          <div class="flex items-center gap-4">
            <button
              type="submit"
              class="flex-1 rounded-full px-6 py-3 text-sm font-semibold text-white bg-gradient-to-r from-primary-600 to-accent-500 hover:from-primary-700 hover:to-accent-600 focus:outline-none focus:ring-2 focus:ring-primary-600 focus:ring-offset-2 focus:ring-offset-slate-900 transition-all"
            >
              Count Me In! ðŸš€
            </button>
          </div>

          <div id="form-status" class="text-center hidden">
            <p class="text-emerald-400">
              Thanks for joining! I'll be in touch soon. ðŸŽ‰
            </p>
          </div>
        </form>

        <div
          class="mt-16 grid grid-cols-1 gap-8 sm:grid-cols-2 animate-fade-in"
        >
          <div class="text-center">
            <div class="text-3xl font-bold text-white">10+</div>
            <div class="mt-2 text-sm text-slate-400">
              Builders Already Joined
            </div>
          </div>
          <div class="text-center">
            <div class="text-3xl font-bold text-white">24/7</div>
            <div class="mt-2 text-sm text-slate-400">Community Support</div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <Footer />
</Layout>

<script>
  const form = document.getElementById("signup-form") as HTMLFormElement;
  const formStatus = document.getElementById("form-status") as HTMLDivElement;

  form?.addEventListener("submit", async (e) => {
    e.preventDefault();
    const formData = new FormData(form);

    try {
      const response = await fetch("/api/signup", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          name: formData.get("name"),
          email: formData.get("email"),
          reason: formData.get("reason"),
        }),
      });

      if (response.ok) {
        form.reset();
        formStatus.classList.remove("hidden");
        setTimeout(() => {
          formStatus.classList.add("hidden");
        }, 5000);
      }
    } catch (error) {
      console.error("Error:", error);
    }
  });
</script>
